<Modal::Default @modalIsOpened={{@modalIsOpened}} @options={{@options}} @confirm={{perform this.submitActivity}} @decline={{@onDecline}}>
    <div class="modal-body-container">
        <div class="flex justify-between align-start">
            <div class="flex-1">
                <p class="mb-5 dark:text-gray-100">
                    {{t "modals.order-new-activity.select-message"}}
                </p>
            </div>
            <Button @text="Refresh activity" @icon="refresh" @size="xs" @wrapperClass="self-start" @isLoading={{this.loadActivity.isRunning}} @onClick={{perform this.loadActivity}} />
        </div>

        {{#if this.order.activityHasEnded}}
            <InfoBlock class="warning mt-2" @icon="exclamation-triangle">
                {{t "modals.order-new-activity.order-currently-message" htmlSafe=true options=@options.order.status}}
                {{t "modals.order-new-activity.fleetbase-message"}}
            </InfoBlock>
        {{/if}}

        <fieldset class="my-5">
            <legend class="sr-only">
                {{t "modals.order-new-activity.activity-options"}}
            </legend>

            <div class="radio-group-condensed -space-y-px">
                {{#each this.activityOptions as |activity index|}}
                    <div class="radio-group-item shadow-sm {{if (eq this.selectedActivity index) 'is-checked'}}">
                        <div class="flex items-center h-5">
                            <RadioButton
                                @radioClass="focus:ring-blue-500"
                                @radioId={{concat "activity_" index}}
                                @value={{index}}
                                @groupValue={{this.selectedActivity}}
                                @name={{t "modals.order-new-activity.activity"}}
                                @changed={{fn (mut this.selectedActivity)}}
                            />
                        </div>
                        <label for={{concat "activity_" index}} class="ml-3 flex flex-col cursor-pointer w-full">
                            <span class="block text-sm font-semibold">
                                {{activity.status}}
                            </span>
                            <span class="block text-sm">
                                {{activity.details}}

                                {{#if (eq activity.code "dispatched")}}
                                    <InfoBlock
                                        @type="warning"
                                        @size="xs"
                                        @icon="exclamation-triangle"
                                        @text={{t "modals.order-new-activity.dispatch"}}
                                        class="mt-1"
                                    />
                                {{/if}}
                            </span>
                        </label>
                        <div>
                            <Badge @status={{dasherize activity.code}} class="uppercase">{{activity.code}}</Badge>
                        </div>
                    </div>
                {{/each}}

                <div class="radio-group-item shadow-sm {{if (eq this.selectedActivity 'custom') 'is-checked'}}">
                    <div class="flex items-center h-5 pt-1">
                        <RadioButton
                            @radioClass="focus:ring-blue-500"
                            @radioId="activity_custom"
                            @value="custom"
                            @groupValue={{this.selectedActivity}}
                            @name={{t "modals.order-new-activity.activity"}}
                            @changed={{fn (mut this.selectedActivity)}}
                        />
                    </div>
                    <label for="activity_custom" class="ml-3 flex flex-col cursor-pointer w-full pr-5">
                        <div class="font-semibold text-sm mb-1">Add custom activity</div>
                        <span class="block text-sm font-medium">
                            <Input @type="text" @value={{this.customActivity.status}} class="form-input form-input-sm w-full rounded-b-none" placeholder={{t "modals.order-new-activity.status"}} />
                        </span>
                        <span class="block text-sm">
                            <Input @type="text" @value={{this.customActivity.details}} class="form-input form-input-sm w-full rounded-t-none" placeholder={{t "modals.order-new-activity.details"}} />
                        </span>
                    </label>
                    <div>
                        <Input @type="text" @value={{this.customActivity.code}} class="form-input form-input-sm" placeholder={{t "modals.order-new-activity.code"}} />
                    </div>
                </div>
            </div>
        </fieldset>
    </div>
</Modal::Default>